!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Grade=e()}(function(){return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){return i(t[o][1][e]||e)},h,h.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callback=r||null,this.container=t,this.image=this.container.querySelector(n)||this.container.querySelector("img"),this.gradientData=[],this.image&&this.container&&(this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.imageDimensions={width:0,height:0},this.imageData=[],this.readImage())}return r(e,[{key:"readImage",value:function(){this.imageDimensions.width=.1*this.image.width,this.imageDimensions.height=.1*this.image.height,this.render()}},{key:"getImageData",value:function(){var e=this.ctx.getImageData(0,0,this.imageDimensions.width,this.imageDimensions.height).data;this.imageData=Array.from(e)}},{key:"getChunkedImageData",value:function(){return this.imageData.reduce(function(e,t,n){var r=Math.floor(n/4);return e[r]||(e[r]=[]),e[r].push(t),e},[]).filter(function(e){return e.slice(0,2).every(function(e){return e<250})&&e.slice(0,2).every(function(e){return e>0})})}},{key:"getRGBAGradientValues",value:function(e){return e.map(function(e,t){return"rgba("+e.rgba.slice(0,3).join(",")+",0.8) "+(0==t?"-150%":"100%")}).join(",")}},{key:"getCSSGradientProperty",value:function(e){return"background-image: radial-gradient("+this.getRGBAGradientValues(e)+")"}},{key:"getMiddleRGB",value:function(e,t){return[parseInt(.5*e[0]+.5*t[0]),parseInt(.5*e[1]+.5*t[1]),parseInt(.5*e[2]+.5*t[2])]}},{key:"getSortedValues",value:function(e){return Object.keys(e).map(function(t){var n=t,r=t.split("|"),i=(299*r[0]+587*r[1]+114*r[2])/1e3;return{rgba:n.split("|"),occurs:e[t],brightness:i}}).sort(function(e,t){return e.occurs-t.occurs}).reverse().slice(0,10).sort(function(e,t){return e.brightness-t.brightness}).reverse()}},{key:"getTextProperty",value:function(e){var t=this.getMiddleRGB(e[0].rgba.slice(0,3),e[1].rgba.slice(0,3)),n=63.75+.75*t[0],r=63.75+.75*t[1],i=63.75+.75*t[2],a=function(e){let t=function(e){let t=e.substring(4,e.length-1).replace(/ /g,"").split(",");return function(e,t,n){e/=255,t/=255,n/=255;var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),u=(a+o)/2;if(a==o)r=i=0;else{var s=a-o;switch(i=u>.5?s/(2-a-o):s/(a+o),a){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r/=6}return[r,i,u]}(t[0],t[1],t[2])}("rgb("+Math.round(n)+", "+Math.round(r)+", "+Math.round(i)+")");return t[0]=(t[0]+.5)%1,t[1]=(t[1]+.5)%1,t[2]=(t[2]+.5)%1,function(e,t,n){var r,i,a;if(0==t)r=i=a=n;else{var o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},u=n<.5?n*(1+t):n+t-n*t,s=2*n-u;r=o(s,u,e+1/3),i=o(s,u,e),a=o(s,u,e-1/3)}return[Math.round(255*r),Math.round(255*i),Math.round(255*a)]}(t[0],t[1],t[2])}();return Math.round((299*parseInt(t[0])+587*parseInt(t[1])+114*parseInt(t[2]))/1e3)>165?"border-color: rgb("+a[0]+", "+a[1]+", "+a[2]+"); color: #000;":"border-color: rgb("+a[0]+", "+a[1]+", "+a[2]+"); color: #fff;"}},{key:"getTopValues",value:function(e){var t=this.getSortedValues(e);return[t[0],t[t.length-1]]}},{key:"getUniqValues",value:function(e){return e.reduce(function(e,t){var n=t.join("|");return e[n]?(e[n]=++e[n],e):(e[n]=1,e)},{})}},{key:"renderGradient",value:function(){var e,t=this.getChunkedImageData();e=this.getTopValues(this.getUniqValues(t)),this.callback&&(this.gradientData=this.getTextProperty(e));var n=this.getCSSGradientProperty(e),r=this.getTextProperty(e),i=(this.container.getAttribute("style")||"")+"; "+n+"; "+r+"; background-color: white";this.container.setAttribute("style",i)}},{key:"render",value:function(){this.canvas.width=this.imageDimensions.width,this.canvas.height=this.imageDimensions.height,this.ctx.drawImage(this.image,0,0,this.imageDimensions.width,this.imageDimensions.height),this.getImageData(),this.renderGradient()}}]),e}();t.exports=function(e,t,n){var r=function(e,t,n){var r=new i(e,t,n).gradientData;return r.length?{element:e,gradientData:r}:null},a=(NodeList.prototype.isPrototypeOf(e)?Array.from(e).map(function(e){return r(e,t,n)}):[r(e,t,n)]).filter(Boolean);if(a.length)return n(a)}},{}]},{},[1])(1)});